@startuml
'https://plantuml.com/class-diagram

title US004 - As Administrator, I want to search for users

skinparam classAttributeIconSize 0

package "System" <<Rectangle>> {

package "Infrastructure" <<Rectangle>> #lightblue  {
class "SearchUsersByXRoute" as route << Component >>
}

package "Interface Adapters" <<Rectangle>> #lightgreen {
package "Controllers" <<rectangle>>{
class "SearchUsersByXController" as ctrl << Component >> {
+getUsersByX()
}
}
package "Repositories" <<rectangle>>{
class "SystemUserStore" as store << Repository >> {
-users : List<SystemUser>
+findAll()
}
class "UserProfileStore" as uPStore << Repository >> {
-profiles : List<UserProfile>
+existById()
}
}
}

package "Application Service" <<Rectangle>> #lightpink{
package "App Services" <<rectangle>>{
class "SearchUsersByXService" as srv << Service >> {
+getUsersByX()
}
}
package "IRepositories" <<rectangle>>{
interface "ISystemUserRepository" as repo{
findAll()
}
interface "IUserProfileRepository" as uPRepo{
existById()
}
}
}

package "Domain" <<Rectangle>> #burlywood{
package "Services" <<Rectangle>>{
class "GetUsersByXService" as dsrv <<Service>>{
+getUsersByX()
}
}
package "Aggregates" <<rectangle>>{
package "SystemUser" <<Rectangle>>{
entity "SystemUser" as user << Root >> {
-userName : Name
-userFunction : Function
+ hasName()
+ hasEmail()
+ hasProfile()
+ hasFunction()
}
}
package "UserProfile" <<Rectangle>>{
entity "UserProfile" as profile << Root >>
}
}
package "Value Object" <<rectangle>>{
class "SystemUserId" as uId << Value Object >> {
systemUserId : Email
}
class "UserProfileId" as uPId << Value Object >> {
UserProfileId : Description
}
}
}

package "DTO" <<rectangle>>{
class "GetUsersByXMapper" as map <<Component>> {
+ data2Dto()
+ model2Dto()
+ dto2Json()
}
class "dataDTO" as dataDto <<Component>>{
+ name : String
+ email : String
+ profile : String
+ function : String
}
class "userDTO" as dto <<Component>>{
+ userName : String
+ userEmail : String
}

class "userJson" as json <<Component>>{
+ userName : String
+ userEmail : String
}
}
}

route .d.> ctrl
ctrl .d..> srv
srv .u.> repo
srv .u.> uPRepo
srv ...> dsrv
repo <|.u. store
uPRepo <|.u. uPStore
store "1"*----"*" user
uPStore "1"*----"*" profile
dsrv ..> user
user "1"*-d-"1" uId
profile "1"*-d-"1" uPId
ctrl .d.> map
srv .u.> map
map .r.> dto
map .l.> json
map ..> user
map ..> dataDto

@enduml